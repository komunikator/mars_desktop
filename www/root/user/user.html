<!DOCTYPE html>
<html>


    <head>
        <title>Client</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="Author" content="Jose Luis Millan, Inaki Baz Castillo" />
        <!--  <link rel="stylesheet" href="css/style.css" type="text/css" />-->
        <style>
            body {margin:0px; padding:0px;}
        </style>

        <script src="js/jquery-1.11.3.min.js"></script>
        <script src="js/providers.js"></script>

        <link type="text/css" href="css/jquery-ui.css" rel="stylesheet" />
        <link type="text/css" href="css/user.css" rel="stylesheet" />
        <script src="js/jquery-ui.js"></script>

        <script>

            /* - - определяется основной язык пользовател и по этому параметру
             * выбираем какой файл css подключать - - - - - - - - - - - - - */
            function getUrlVars()
            {
                var vars = [], hash;
                var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                for (var i = 0; i < hashes.length; i++)
                {
                    hash = hashes[i].split('=');
                    vars.push(hash[0]);
                    vars[hash[0]] = hash[1];
                }
                return vars;
            }

            var lang = getUrlVars()["lang"];
            (lang == 'ru') ? docss("ru.css") : (lang == 'en') ? docss("en.css") : docss("ru.css");

            function docss(name)
            {
                var st = document.createElement("link");
                st.setAttribute("rel", "stylesheet");
                st.setAttribute("href", "css/" + name);
                document.getElementsByTagName("head")[0].appendChild(st)
            }

        </script>

        <style>
            body{
                font: 100% "Trebuchet MS", sans-serif;
            }
            .demoHeaders {
                margin-top: 2em;
            }
            #add-sipconnect {
                padding: .4em 1em .4em 20px;
                text-decoration: none;
                position: relative;
            }
            #add-sipconnect span.ui-icon {
                margin: 0 5px 0 0;
                position: absolute;
                left: .2em;
                top: 50%;
                // margin-top: -8px;
            }
            #exit {
                padding: .4em 1em .4em 20px;
                text-decoration: none;
                position: relative;
            }
            #icons {
                margin: 0;
                padding: 0;
            }
            #icons li {
                margin: 2px;
                position: relative;
                padding: 4px 0;
                cursor: pointer;
                float: left;
                list-style: none;
            }
            #icons span.ui-icon {
                float: left;
                margin: 0 4px;
            }
            .fakewindowcontain .ui-widget-overlay {
                position: absolute;
            }
            select {
                width: 200px;
            }
        </style>
    </head>


    <body id="body" class="bg01">

        <div id="user-login-form" class="ui-widget ui-widget-content ui-corner-all user-login" >
            <div class="ui-dialog-content ui-widget-content" style="background: none; border: 0;">
                <table style="margin-bottom: 20px; margin-top: 20px; width:100%">
                    <tr>
                        <td>
                            <span class="text-login"></span>
                        </td>
                        <td>
                            <input id="user-login" title="type &quot;a&quot;" class="ui-autocomplete-input" autocomplete="off" >
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span class="text-password"></span>
                        </td>
                        <td>
                            <input id="user-password" type="password" title="type &quot;a&quot;" class="ui-autocomplete-input" autocomplete="off" >
                        </td>
                    </tr>
                </table>
                <div class="ui-dialog-buttonset" style="float:right; ">
                    <button id="button-login-ok" type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button">
                        <span class="ui-button-text">Ok</span>
                    </button>
                </div>
            </div>
        </div>
        <!---->


        <div id="user-status-form" class="ui-widget ui-widget-content ui-corner-all user-status" >
            <div class="ui-dialog-content ui-widget-content" style="background: none; border: 0;">
                <div id="refresh-button"></div>
                <table id="list-sip-connection" cellpadding="7" style="margin: 15px;border-collapse: collapse; width: 90%">
                    <caption style="margin-bottom: 20px;">SIP Подключения</caption>
                    <tr></tr>
                </table>
                <div id="contextMenuId" style="position:absolute; top:0; left:0; border:1px solid #666; background-color:#CCC; display:none; float:left; z-index: 100;"></div>
                <p style="text-align: center;"><a href="#" id="add-sipconnect" class="ui-state-default ui-corner-all add-button-text">
                    </a>
                </p>
            </div>
        </div>
        <!---->


        <div id="user-panel-form" class="ui-widget ui-widget-content ui-corner-all user-panel" >
            <div class="ui-dialog-content ui-widget-content" style="background: none; border: 0;">
            	<p style="text-align: center;"><a href="/logOut" id="exit" class="ui-state-default ui-corner-all exit-button-text">
                    </a>
                </p>
            </div>
        </div>
        <!---->


        <div id="user-master-form">
            <div id="choice-page" class="page1">
                <p class="choice_text"></p>
                <form style="margin-top: 1em;">
                    <div id="radioset">
                    </div>
                </form>
            </div>
            <div id="enterData-page" class="page2">
                <table style="margin-bottom: 20px; margin-top: 20px; width:100%">
                    <tr>
                        <td>
                            <span class="text-login"></span>
                        </td>
                        <td>
                            <input id="userSipName" title="type &quot;a&quot;" class="ui-autocomplete-input" autocomplete="off" >
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span class="text-password"></span>
                        </td>
                        <td>
                            <input id="userSipPassword" type="password" title="type &quot;a&quot;" class="ui-autocomplete-input" autocomplete="off" >
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <!---->
        <div id="question-shour-form">
            <div id="choice-page" class="page1">
                <p class="shour_text"></p>
                <form style="margin-top: 1em;">
                </form>
            </div>
        </div>


        <script src="js/user.js"></script>
        <script>

            //загрузка списка провайдеров из providers.js
            getProvidersList();

            $("#accordion").accordion();
            var availableTags = [
                "ActionScript",
                "AppleScript",
                "Asp",
                "BASIC",
                "C",
                "C++",
                "Clojure",
                "COBOL",
                "ColdFusion",
                "Erlang",
                "Fortran",
                "Groovy",
                "Haskell",
                "Java",
                "JavaScript",
                "Lisp",
                "Perl",
                "PHP",
                "Python",
                "Ruby",
                "Scala",
                "Scheme"
            ];
            $("#autocomplete").autocomplete({
                source: availableTags
            });



            $("#button").button();
            $("#button-login-ok").button();
            $("#radioset").buttonset();



            $("#tabs").tabs();



            $("#user-master-form").dialog({
                autoOpen: false,
                width: 450,
                modal: true, //inactive background
                buttons: [
                    {
                        id: "next_button",
                        class: "next_text",
                        click: function () {
                            if ($('#choice-page').is(":visible")) {
                                var elements = document.getElementsByName("provider");
                                var check = false;

                                for (var i = 0; i < elements.length; i++) {
                                    if (elements[i].checked) {
                                        check = true;
                                        idProvider = elements[i].id;
                                        break;
                                    }
                                }
                                if (check) {
                                    $("#choice-page").hide();
                                    $("#next_button").removeClass("next_text");
                                    $("#next_button").addClass("ready_text");
                                    $("#enterData-page").show();
                                } else
                                {
                                    alert("Choice something");
                                }
                            }
                            else if ($('#enterData-page').is(":visible")) {
                                var sipLogin = $("#userSipName").val();
                                var sipPass = $("#userSipPassword").val();

                                if (sipLogin == "" || sipPass == "") {
                                    alert("Check whether all the fields are filled");
                                }
                                else {

                                    actionSipConnection();

                                    $(this).dialog("close");
                                    $("#choice-page").show();
                                    $("#enterData-page").hide();

                                    $("#next_button").removeClass("ready_text");
                                    $("#next_button").addClass("next_text");
                                }
                            }
                        }
                    },
                    {
                        class: "cancel_text",
                        click: function () {
                            idSipRecord = null;
                            idProvider = null;
                            $("#userSipName").val('');
                            $("#userSipPassword").val('');
                            $(this).dialog("close");

                            $("#choice-page").show();
                            $("#enterData-page").hide();

                        }
                    }
                ]
            });


            $("#question-shour-form").dialog({
                autoOpen: false,
                width: 350,
                modal: true, //inactive background
                buttons: [
                    {
                        id: "yes_button",
                        class: "yes_text",
                        click: function () {
                            $.ajax({
                                url: '/resourceData/settings',
                                method: 'get',
                                success: function (response) {
                                    var data = jQuery.parseJSON(response.data[0].value);

                                    data.sipAccounts.splice(idSipRecord, 1);
                                    response.data[0].create = false;
                                    response.data[0].name = 'config/config';
                                    response.data[0].value = JSON.stringify(data, null, 4);

                                    $.ajax({
                                        url: "/resourceData/update",
                                        method: 'put',
                                        data: response.data[0],
                                        success: function (response) {
                                            $.get("http://" + hostname + ":" + port + "/resourceData/settings", displaySipTable);
                                        }
                                    });
                                    idSipRecord = null;
                                    idProvider = null;
                                }
                            });
                            $(this).dialog("close");
                        }
                    },
                    {
                        class: "no_text",
                        click: function () {
                            idSipRecord = null;
                            idProvider = null;
                            $(this).dialog("close");
                        }
                    }
                ]
            });

// Link to open the dialog
            $("#add-sipconnect").click(function (event) {
                idSipRecord = null;
                $("#user-master-form").dialog("open");
                event.preventDefault();
            });


            $("#datepicker").datepicker({
                inline: true
            });



            $("#slider").slider({
                range: true,
                values: [17, 67]
            });



            $("#progressbar").progressbar({
                value: 20
            });



            $("#spinner").spinner();



            $("#menu").menu();



            $("#tooltip").tooltip();



            $("#selectmenu").selectmenu();


// Hover states on the static widgets
            $("#add-sipconnect, #icons li").hover(
                    function () {
                        $(this).addClass("ui-state-hover");
                    },
                    function () {
                        $(this).removeClass("ui-state-hover");
                    }
            );
        </script>

    </body>
</html>
